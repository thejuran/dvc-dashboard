---
phase: 09-ux-security-polish
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/components/Layout.tsx
  - frontend/src/index.css
  - frontend/src/pages/DashboardPage.tsx
  - frontend/src/pages/ContractsPage.tsx
  - frontend/src/pages/ReservationsPage.tsx
  - frontend/src/pages/AvailabilityPage.tsx
  - frontend/src/pages/PointChartsPage.tsx
  - frontend/src/pages/ScenarioPage.tsx
  - frontend/src/pages/TripExplorerPage.tsx
  - frontend/src/pages/SettingsPage.tsx
  - frontend/src/components/DashboardSummaryCards.tsx
  - frontend/src/components/ContractCard.tsx
  - frontend/src/components/ReservationCard.tsx
  - frontend/src/components/BookingImpactPanel.tsx
  - frontend/src/components/CostHeatmap.tsx
  - frontend/src/components/ScenarioComparison.tsx
  - frontend/src/components/TripExplorerForm.tsx
  - frontend/src/components/TripExplorerResults.tsx
autonomous: true

must_haves:
  truths:
    - "On a 375px viewport, the sidebar collapses and a hamburger menu button appears to toggle navigation"
    - "On a 375px viewport, all page content is readable and not clipped or overflowing horizontally"
    - "Card grids stack to single column on mobile and expand to multi-column on wider screens"
    - "Forms are usable on mobile -- inputs are full-width and buttons are tap-sized"
    - "Tables scroll horizontally on mobile rather than breaking layout"
  artifacts:
    - path: "frontend/src/components/Layout.tsx"
      provides: "Responsive sidebar that collapses to hamburger menu on mobile"
  key_links:
    - from: "frontend/src/components/Layout.tsx"
      to: "frontend/src/index.css"
      via: "Sidebar overlay and transition styles"
      pattern: "md:w-64|sidebar|hamburger|menu"
---

<objective>
Make the app fully usable on mobile (375px+) and tablet viewpoints by converting the fixed sidebar to a responsive hamburger menu and ensuring all pages, cards, tables, and forms adapt gracefully to narrow screens.

Purpose: UX-03 (mobile responsive) -- every page must render correctly and be usable on a 375px mobile viewport and tablet.

Output: Responsive Layout with collapsible sidebar, and responsive adjustments across all page components.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@frontend/src/components/Layout.tsx
@frontend/src/App.tsx
@frontend/src/index.css
@frontend/src/pages/DashboardPage.tsx
@frontend/src/pages/ContractsPage.tsx
@frontend/src/pages/ReservationsPage.tsx
@frontend/src/pages/PointChartsPage.tsx
@frontend/src/pages/AvailabilityPage.tsx
@frontend/src/pages/TripExplorerPage.tsx
@frontend/src/pages/ScenarioPage.tsx
@frontend/src/pages/SettingsPage.tsx
@frontend/src/components/DashboardSummaryCards.tsx
@frontend/src/components/CostHeatmap.tsx
@frontend/src/components/ScenarioComparison.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Convert Layout to responsive sidebar with hamburger menu</name>
  <files>
    frontend/src/components/Layout.tsx
    frontend/src/index.css
  </files>
  <action>
    Rewrite Layout.tsx to implement responsive sidebar:

    **Mobile behavior (below md/768px):**
    - Hide the sidebar by default.
    - Show a top bar with the app title "DVC Dashboard" on the left and a hamburger menu button (Menu icon from lucide-react) on the right.
    - When hamburger is tapped, show the sidebar as a slide-in overlay from the left with a semi-transparent backdrop.
    - The overlay sidebar uses the same nav items list. Each NavLink click closes the sidebar (set state to closed).
    - Add a close button (X icon) inside the overlay sidebar header.
    - Use React state `sidebarOpen` (boolean) to control visibility.
    - On route change, close the sidebar. Use `useLocation` from react-router-dom to detect route changes in a useEffect.

    **Desktop behavior (md and above):**
    - Keep the existing fixed sidebar layout exactly as-is: `w-64 border-r bg-muted/40 p-6` with nav items.
    - The hamburger button and mobile top bar are hidden (use `hidden md:flex` / `md:hidden` Tailwind classes).

    **Implementation approach:**
    - Use Tailwind responsive classes, NOT JavaScript for show/hide of the desktop sidebar.
    - The mobile overlay sidebar should use: `fixed inset-0 z-50` for the backdrop, `fixed left-0 top-0 bottom-0 w-64 z-50 bg-background border-r` for the sidebar panel, with a `translate-x` transform for slide animation.
    - Add transition classes: `transition-transform duration-200 ease-in-out` on the sidebar panel. When closed: `-translate-x-full`. When open: `translate-x-0`.
    - The backdrop is a `fixed inset-0 bg-black/50 z-40` div that only renders when sidebarOpen is true.

    **Main content area:**
    - Change `<main className="flex-1 p-8">` to `<main className="flex-1 p-4 md:p-8">` for tighter mobile padding.
    - On mobile, add top padding to account for the fixed top bar: `pt-16 md:pt-8` (the mobile top bar is ~h-14).

    **Mobile top bar:**
    - Render a `fixed top-0 left-0 right-0 h-14 border-b bg-background z-30 flex items-center justify-between px-4 md:hidden` div.
    - Contains: app title on left, hamburger button on right.

    No external animation libraries. Pure Tailwind transitions.
  </action>
  <verify>
    Run `cd frontend && npx tsc --noEmit` -- zero TypeScript errors.
    Run `cd frontend && npm run build` -- build succeeds.
    Verify Layout.tsx contains responsive classes (md:flex, md:hidden, translate-x).
  </verify>
  <done>
    Sidebar is hidden on mobile with a hamburger toggle, visible as fixed sidebar on desktop (md+). Mobile overlay slides in with backdrop. Route changes close the sidebar.
  </done>
</task>

<task type="auto">
  <name>Task 2: Make pages, cards, tables, and forms responsive at 375px</name>
  <files>
    frontend/src/pages/DashboardPage.tsx
    frontend/src/pages/ContractsPage.tsx
    frontend/src/pages/ReservationsPage.tsx
    frontend/src/pages/AvailabilityPage.tsx
    frontend/src/pages/PointChartsPage.tsx
    frontend/src/pages/ScenarioPage.tsx
    frontend/src/pages/TripExplorerPage.tsx
    frontend/src/pages/SettingsPage.tsx
    frontend/src/components/DashboardSummaryCards.tsx
    frontend/src/components/ContractCard.tsx
    frontend/src/components/ReservationCard.tsx
    frontend/src/components/BookingImpactPanel.tsx
    frontend/src/components/CostHeatmap.tsx
    frontend/src/components/ScenarioComparison.tsx
    frontend/src/components/TripExplorerForm.tsx
    frontend/src/components/TripExplorerResults.tsx
  </files>
  <action>
    Audit and fix each page/component for 375px viewport. The principle: stack on mobile, expand on desktop.

    **Page headers (all pages):**
    - Where pages have `flex items-center justify-between`, ensure they wrap on mobile: change to `flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between` so the title and action button stack vertically on narrow screens.

    **DashboardSummaryCards.tsx:**
    - Current: `grid gap-4 sm:grid-cols-2 lg:grid-cols-4`. This is already responsive. Verify it works at 375px (should show single column). Keep as-is if it works.

    **ContractsPage.tsx:**
    - Current grid: `grid gap-4 sm:grid-cols-1 md:grid-cols-2 xl:grid-cols-3`. This is fine. Keep.

    **ReservationsPage.tsx:**
    - Current grid: `grid gap-4 sm:grid-cols-1 md:grid-cols-2`. Fine. Keep.
    - Filter bar: `flex items-center gap-4` -- make it wrap: `flex flex-wrap items-center gap-3`.

    **AvailabilityPage.tsx:**
    - Date input `w-48` -- change to `w-full sm:w-48` so it's full width on mobile.
    - Card grid: `grid gap-4 sm:grid-cols-1 md:grid-cols-2`. Fine.

    **PointChartsPage.tsx:**
    - Chart selector: `flex items-center gap-4` -- make it stack on mobile: `flex flex-col gap-3 sm:flex-row sm:items-center sm:gap-4`.
    - Select triggers with fixed widths (`w-[240px]`, `w-[120px]`) -- change to `w-full sm:w-[240px]` and `w-full sm:w-[120px]`.
    - Tabs: `flex gap-0` -- add `overflow-x-auto` so tabs scroll horizontally if they don't fit.
    - PointChartTable: If it uses a `<table>`, wrap it in `<div className="overflow-x-auto">` for horizontal scroll on mobile.

    **ScenarioPage.tsx:**
    - Page header with FlaskConical icon: make it wrap properly on mobile.
    - ScenarioComparison.tsx: If it has a comparison table, wrap in `overflow-x-auto`.

    **TripExplorerPage.tsx:**
    - TripExplorerForm.tsx: Date inputs should be full-width on mobile. If they use a horizontal flex layout, change to `flex flex-col gap-3 sm:flex-row sm:items-end sm:gap-4`.
    - TripExplorerResults.tsx: If it has a results table, wrap in `overflow-x-auto`. If it has card grids, ensure they stack on mobile.

    **SettingsPage.tsx:**
    - Borrowing policy buttons: `flex gap-3` -- change to `flex flex-col gap-3 sm:flex-row sm:gap-3` so options stack on mobile.

    **CostHeatmap.tsx:**
    - Heatmaps are typically wide. Wrap the heatmap container in `overflow-x-auto` so it scrolls horizontally on mobile rather than breaking layout.

    **BookingImpactPanel.tsx:**
    - If it has horizontal layouts, ensure they wrap on mobile.

    **General rules to apply everywhere:**
    - No fixed pixel widths without sm: responsive override.
    - All `<table>` elements get an `overflow-x-auto` parent wrapper.
    - Text should not overflow -- use `break-words` if needed on long text.
    - Buttons should be at least 44px touch target (Tailwind size-11 or py-2.5 px-4 minimum).
  </action>
  <verify>
    Run `cd frontend && npx tsc --noEmit` -- zero TypeScript errors.
    Run `cd frontend && npm run build` -- build succeeds.
    Run `cd frontend && npx eslint .` -- zero warnings.
    Grep for problematic fixed widths: `grep -rn "w-\[" frontend/src/pages/ frontend/src/components/ | grep -v "sm:\|md:\|lg:\|overflow"` -- review output to confirm no unresponsive fixed widths remain on primary layout elements (some on small internal elements are acceptable).
  </verify>
  <done>
    All pages render correctly at 375px: page headers stack, card grids collapse to single column, tables scroll horizontally, form inputs are full-width, sidebar is hamburger-driven. No content is clipped or overflowing.
  </done>
</task>

</tasks>

<verification>
1. `cd frontend && npm run build` succeeds
2. `cd frontend && npx tsc --noEmit` returns zero errors
3. `cd frontend && npx eslint .` returns zero warnings
4. Layout.tsx has responsive sidebar with hamburger menu button
5. No horizontal overflow on any page at 375px viewport
6. All card grids stack to single column on mobile
7. All tables have overflow-x-auto wrapper for horizontal scroll
</verification>

<success_criteria>
- Layout sidebar collapses to hamburger menu on screens below 768px
- All 8 pages are usable on a 375px viewport without horizontal scrolling or clipped content
- Card grids, form layouts, and filter bars adapt from multi-column to stacked layout on mobile
- Tables scroll horizontally on narrow screens instead of breaking layout
- Zero TypeScript errors, zero eslint warnings, build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/09-ux-security-polish/09-02-SUMMARY.md`
</output>
